<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Geir Bolstad" />

<meta name="date" content="2019-07-21" />

<title>Rate models</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Rate models</h1>
<h4 class="author">Geir Bolstad</h4>
<h4 class="date">2019-07-21</h4>



<p>This vignette shows how to use the <code>rate_gls</code> function. This function can fit three different types of evolutionary models depending on the <code>model</code> argument of the function. In all models the evolutionary rate of change in the y-variable is a function of the state of the predictor x. It can be used to test hypotesis about the effect of an evolving trait (x) on the rate of evolution in a different trait (y). The different evolutionary models are outlined below. However, to simulate data for the different evolutionary models, we first need an ultrametric phylogeny.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">tree &lt;-<span class="st"> </span>geiger<span class="op">::</span><span class="kw">sim.bdtree</span>(<span class="dt">b =</span> <span class="dv">1</span>, <span class="dt">d =</span> <span class="dv">0</span>, <span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">t =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#&gt; Registered S3 method overwritten by 'geiger':</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt;   method            from</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt;   unique.multiPhylo ape</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">ape<span class="op">::</span><span class="kw">is.ultrametric</span>(tree)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>We scale the tree to unit length between root and tips. (This makes the parameters easier to interpret)</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">tree<span class="op">$</span>edge.length &lt;-<span class="st"> </span>tree<span class="op">$</span>edge.length<span class="op">/</span><span class="kw">diag</span>(ape<span class="op">::</span><span class="kw">vcv</span>(tree))[<span class="dv">1</span>]</a></code></pre></div>
<div id="predictor-as-brownian-motion" class="section level1">
<h1>Predictor as Brownian motion</h1>
<p>The first model is a model where the predictor <span class="math inline">\(x\)</span> evolves according to a Brownian motion (BM) process, the evolutionary model is</p>
<p><span class="math display">\[dy = \sqrt{a + bx} dW_i \]</span></p>
<p><span class="math display">\[dx = \sigma dW_i \]</span> where the <span class="math inline">\(dW_i\)</span> are uncorrelated white noise. This means that <span class="math inline">\(y\)</span> is following a Brownian motion with variance linear in <span class="math inline">\(x\)</span>, and <span class="math inline">\(x\)</span> itself is assumed to follow a standard Brownian motion with variance <span class="math inline">\(\sigma^2\)</span>. The influence of <span class="math inline">\(x\)</span> is characterized by the parameter <span class="math inline">\(b\)</span>. This model will break down when <span class="math inline">\(a + bx\)</span> becomes negative, and should be seen as an approximation that may be valid for a given range of <span class="math inline">\(x\)</span> values as spanned by the species to be used in the analysis. Using the function <code>simulate_rate</code> with <code>model = &quot;predictor_BM&quot;</code> we can simulate data with different parameter values.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">sim_data &lt;-<span class="st"> </span><span class="kw">simulate_rate</span>(tree, <span class="dt">startv_x=</span><span class="dv">0</span>, <span class="dt">sigma_x=</span><span class="dv">1</span>, <span class="dt">a=</span><span class="dv">2</span>, <span class="dt">b=</span><span class="dv">1</span>, <span class="dt">model =</span> <span class="st">&quot;predictor_BM&quot;</span>)</a></code></pre></div>
<p>In this simulation often gives a warning message because the rate parameter, a + bx, is negative. In these instances, the rate parameter is assignd the value 0 in the simulaiton. As long as the number of these instances is low, this should not be a problem.<br />
We can now fit the gls model to these data</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">gls_mod &lt;-<span class="st"> </span><span class="kw">rate_gls</span>(<span class="dt">x=</span>sim_data<span class="op">$</span>x, <span class="dt">y=</span>sim_data<span class="op">$</span>y, <span class="dt">species=</span>sim_data<span class="op">$</span>species, tree, <span class="dt">model =</span> <span class="st">&quot;predictor_BM&quot;</span>, <span class="dt">maxiter =</span> <span class="dv">100</span>, <span class="dt">silent =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; &lt;sparse&gt;[ &lt;logic&gt; ] : .M.sub.i.logical() maybe inefficient</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">gls_mod<span class="op">$</span>param</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt;            Estimate        SE</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; Intercept 3.5759020 1.3052055</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; Slope     0.5491529 0.6179300</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; a         3.5759020 1.3052055</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; b         1.0983058 1.2358601</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; sigma2_x  0.8031986 0.1124703</span></a></code></pre></div>
<p>This gives the parameters of the model. The parameters “Intercept (A)” and “Slope (B)” gives the gls estimates of the regression of y<sup>2</sup> on x. The a, b and Sigma2_x are the parameters of the evolutonary model. The standard error of the estimates does not take into account the error in Sigma2_x. Parametric boostrapping can be used to get 95% confidence intervals taking into account error in the entire process (assuming that the phylogenetic tree is true).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">boot_rate_gls</span>(gls_mod, <span class="dt">n =</span> <span class="dv">5</span>) <span class="co"># when doing a proper boostrap n should be larger n&gt;999</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; &lt;sparse&gt;[ &lt;logic&gt; ] : .M.sub.i.logical() maybe inefficient</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; [1] &quot;Bootstrap iteration 1&quot;</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; &lt;sparse&gt;[ &lt;logic&gt; ] : .M.sub.i.logical() maybe inefficient</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; [1] &quot;Bootstrap iteration 2&quot;</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; &lt;sparse&gt;[ &lt;logic&gt; ] : .M.sub.i.logical() maybe inefficient</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; [1] &quot;Bootstrap iteration 3&quot;</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; &lt;sparse&gt;[ &lt;logic&gt; ] : .M.sub.i.logical() maybe inefficient</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; [1] &quot;Bootstrap iteration 4&quot;</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; &lt;sparse&gt;[ &lt;logic&gt; ] : .M.sub.i.logical() maybe inefficient</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; [1] &quot;Bootstrap iteration 5&quot;</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt;              Estimate        SE     boot_SE          2.5%           50%</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; Intercept 3.575901965 1.3052055 1.263896719  1.7283122436  3.2690135725</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; Slope     0.549152904 0.6179300 0.227436412 -0.2190065946 -0.1284508142</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt; a         3.575901965 1.3052055 1.263896719  1.7283122436  3.2690135725</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt; b         1.098305807 1.2358601 0.454872825 -0.4380131893 -0.2569016284</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt; sigma2_x  0.803198577 0.1124703 0.149863768  0.7263037802  0.8280848361</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt; Rsquared  0.007994585        NA 0.001403897  0.0001220585  0.0006113808</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt;                 97.5%</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt; Intercept 4.748332624</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">#&gt; Slope     0.294986639</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co">#&gt; a         4.748332624</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">#&gt; b         0.589973277</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">#&gt; sigma2_x  1.075561006</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="co">#&gt; Rsquared  0.003365214</span></a></code></pre></div>
<p>Plotting the the generalized least squares regression with <span class="math inline">\(y^2\)</span> on the y-axis (i.e. on the variance scale).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">plot</span>(gls_mod, <span class="dt">scale =</span> <span class="st">&quot;VAR&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> Alternatively we can plot the regression with with <span class="math inline">\(|y|\)</span> on the y-axis (i.e. on the standard deviation scale). This is the default of the plot function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">plot</span>(gls_mod) <span class="co"># with the default scale == &quot;SD&quot;</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="predictor-as-geometric-brownian-motion" class="section level1">
<h1>Predictor as geometric Brownian motion</h1>
</div>
<div id="predictor-affects-rates-of-recent-evolution" class="section level1">
<h1>Predictor affects rates of recent evolution</h1>
<p>EVOLUTIONARY MODEL</p>
<p>Simulating data</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">sim_data &lt;-<span class="st"> </span><span class="kw">simulate_rate</span>(tree, <span class="dt">startv_x=</span><span class="dv">0</span>, <span class="dt">sigma_x=</span><span class="dv">1</span>, <span class="dt">a=</span><span class="dv">3</span>, <span class="dt">b=</span><span class="dv">1</span>, <span class="dt">sigma_y =</span> <span class="dv">2</span>, <span class="dt">model =</span> <span class="st">&quot;recent_evol&quot;</span>)</a></code></pre></div>
<p>Fitting the GLS model</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">gls_mod &lt;-<span class="st"> </span><span class="kw">rate_gls</span>(<span class="dt">x=</span>sim_data<span class="op">$</span>x, <span class="dt">y=</span>sim_data<span class="op">$</span>y, <span class="dt">species=</span>sim_data<span class="op">$</span>species, tree, <span class="dt">model =</span> <span class="st">&quot;recent_evol&quot;</span>, <span class="dt">maxiter =</span> <span class="dv">1000</span>, <span class="dt">silent =</span> <span class="ot">TRUE</span>, <span class="dt">useLFO =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">gls_mod<span class="op">$</span>param</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt;            Estimate        SE</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; Intercept 4.0383653 0.5649332</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; Slope     0.3308828 0.5858642</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; a         2.3451002 0.5649332</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; b         0.3308828 0.5858642</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; sigma2_x  0.9521117 0.1333223</span></a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># boot_rate_gls(gls_mod, n = 5, useLFO = FALSE) </span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co"># when doing a proper boostrap n should be larger n&gt;999</span></a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">plot</span>(gls_mod, <span class="dt">scale =</span> <span class="st">&quot;VAR&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="extra-stuff" class="section level1">
<h1>Extra stuff</h1>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co">#### recent_evol ##</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co"># Testing the estimation of b</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">b_true &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)<span class="op">/</span><span class="dv">50</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4">b_est &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(a_true)){</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">  sim_data &lt;-<span class="st"> </span><span class="kw">try</span>(<span class="kw">simulate_rate</span>(tree, <span class="dt">startv_x=</span><span class="dv">0</span>, <span class="dt">sigma_x=</span><span class="dv">3</span>, <span class="dt">a=</span><span class="dv">10</span>, <span class="dt">b=</span>b_true[i], <span class="dt">sigma_y =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb12-7" data-line-number="7">                                <span class="dt">model =</span> <span class="st">&quot;recent_evol&quot;</span>), <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-8" data-line-number="8">  <span class="cf">if</span>(<span class="kw">is.null</span>(<span class="kw">nrow</span>(sim_data))){</a>
<a class="sourceLine" id="cb12-9" data-line-number="9">    b_est[i] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10">  }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb12-11" data-line-number="11">    gls_mod &lt;-<span class="st"> </span><span class="kw">try</span>(<span class="kw">rate_gls</span>(<span class="dt">x=</span>sim_data<span class="op">$</span>x, <span class="dt">y=</span>sim_data<span class="op">$</span>y, <span class="dt">species=</span>sim_data<span class="op">$</span>species, tree, <span class="dt">model =</span> <span class="st">&quot;recent_evol&quot;</span>,</a>
<a class="sourceLine" id="cb12-12" data-line-number="12">                        <span class="dt">maxiter =</span> <span class="dv">1000</span>, <span class="dt">silent =</span> <span class="ot">TRUE</span>, <span class="dt">useLFO =</span> <span class="ot">FALSE</span>), <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-13" data-line-number="13">    <span class="cf">if</span>(<span class="kw">length</span>(gls_mod) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb12-14" data-line-number="14">      b_est[i] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15">    }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb12-16" data-line-number="16">      <span class="cf">if</span>(gls_mod<span class="op">$</span>convergence <span class="op">!=</span><span class="st"> &quot;Convergence&quot;</span>){</a>
<a class="sourceLine" id="cb12-17" data-line-number="17">        b_est[i] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18">      }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb12-19" data-line-number="19">        b_est[i] &lt;-<span class="st"> </span>gls_mod<span class="op">$</span>param[<span class="st">&quot;b&quot;</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb12-20" data-line-number="20">      }</a>
<a class="sourceLine" id="cb12-21" data-line-number="21">    }</a>
<a class="sourceLine" id="cb12-22" data-line-number="22">  }</a>
<a class="sourceLine" id="cb12-23" data-line-number="23">}</a>
<a class="sourceLine" id="cb12-24" data-line-number="24"></a>
<a class="sourceLine" id="cb12-25" data-line-number="25"><span class="kw">plot</span>(b_true, b_est)</a>
<a class="sourceLine" id="cb12-26" data-line-number="26"><span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb12-27" data-line-number="27"><span class="kw">abline</span>(<span class="kw">lm</span>(b_est<span class="op">~</span>b_true), <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb12-28" data-line-number="28"><span class="co">#lm(b_est~b_true) # this is good</span></a>
<a class="sourceLine" id="cb12-29" data-line-number="29"></a>
<a class="sourceLine" id="cb12-30" data-line-number="30"><span class="co"># Testing the estimation of a</span></a>
<a class="sourceLine" id="cb12-31" data-line-number="31">a_true &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)<span class="op">/</span><span class="dv">25</span></a>
<a class="sourceLine" id="cb12-32" data-line-number="32">a_est &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb12-33" data-line-number="33"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(a_true)){</a>
<a class="sourceLine" id="cb12-34" data-line-number="34">  sim_data &lt;-<span class="st"> </span><span class="kw">try</span>(<span class="kw">simulate_rate</span>(tree, <span class="dt">startv_x=</span><span class="dv">0</span>, <span class="dt">sigma_x=</span><span class="dv">3</span>, <span class="dt">a=</span>a_true[i], <span class="dt">b=</span><span class="dv">0</span>, <span class="dt">sigma_y =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb12-35" data-line-number="35">                                <span class="dt">model =</span> <span class="st">&quot;recent_evol&quot;</span>), <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-36" data-line-number="36">  <span class="cf">if</span>(<span class="kw">is.null</span>(<span class="kw">nrow</span>(sim_data))){</a>
<a class="sourceLine" id="cb12-37" data-line-number="37">    a_est[i] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb12-38" data-line-number="38">  }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb12-39" data-line-number="39">    gls_mod &lt;-<span class="st"> </span><span class="kw">try</span>(<span class="kw">rate_gls</span>(<span class="dt">x=</span>sim_data<span class="op">$</span>x, <span class="dt">y=</span>sim_data<span class="op">$</span>y, <span class="dt">species=</span>sim_data<span class="op">$</span>species, tree, <span class="dt">model =</span> <span class="st">&quot;recent_evol&quot;</span>,</a>
<a class="sourceLine" id="cb12-40" data-line-number="40">                        <span class="dt">maxiter =</span> <span class="dv">1000</span>, <span class="dt">silent =</span> <span class="ot">TRUE</span>, <span class="dt">useLFO =</span> <span class="ot">FALSE</span>), <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-41" data-line-number="41">    <span class="cf">if</span>(<span class="kw">length</span>(gls_mod) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb12-42" data-line-number="42">      a_est[i] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb12-43" data-line-number="43">    }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb12-44" data-line-number="44">      <span class="cf">if</span>(gls_mod<span class="op">$</span>convergence <span class="op">!=</span><span class="st"> &quot;Convergence&quot;</span>){</a>
<a class="sourceLine" id="cb12-45" data-line-number="45">        a_est[i] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb12-46" data-line-number="46">      }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb12-47" data-line-number="47">        a_est[i] &lt;-<span class="st"> </span>gls_mod<span class="op">$</span>param[<span class="st">&quot;a&quot;</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb12-48" data-line-number="48">      }</a>
<a class="sourceLine" id="cb12-49" data-line-number="49">    }</a>
<a class="sourceLine" id="cb12-50" data-line-number="50">  }</a>
<a class="sourceLine" id="cb12-51" data-line-number="51">}</a>
<a class="sourceLine" id="cb12-52" data-line-number="52"><span class="kw">plot</span>(a_true, a_est)</a>
<a class="sourceLine" id="cb12-53" data-line-number="53"><span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb12-54" data-line-number="54"><span class="kw">abline</span>(<span class="kw">lm</span>(a_est<span class="op">~</span>a_true), <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb12-55" data-line-number="55"></a>
<a class="sourceLine" id="cb12-56" data-line-number="56"><span class="co">#lm(a_est~a_true) # this is good</span></a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">n =<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">tree &lt;-<span class="st"> </span>geiger<span class="op">::</span><span class="kw">sim.bdtree</span>(<span class="dt">b =</span> <span class="dv">1</span>, <span class="dt">d =</span> <span class="dv">0</span>, <span class="dt">n =</span> n, <span class="dt">t =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#ape::is.ultrametric(tree)</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4">tree<span class="op">$</span>edge.length &lt;-<span class="st"> </span>tree<span class="op">$</span>edge.length<span class="op">/</span><span class="kw">diag</span>(ape<span class="op">::</span><span class="kw">vcv</span>(tree))[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">A &lt;-<span class="st"> </span>ape<span class="op">::</span><span class="kw">vcv</span>(tree)</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">y &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">chol</span>(A))<span class="op">%*%</span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb13-7" data-line-number="7">X &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="dv">1</span>, n))</a>
<a class="sourceLine" id="cb13-8" data-line-number="8"></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="kw">system.time</span>(<span class="kw">GLS</span>(<span class="dt">y=</span>y, <span class="dt">X =</span> X, <span class="dt">R=</span>A, <span class="dt">coef_only =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="kw">system.time</span>(<span class="kw">GLS</span>(<span class="dt">y=</span>y, <span class="dt">X =</span> X, <span class="dt">R=</span>A, <span class="dt">coef_only =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb13-11" data-line-number="11"></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="kw">GLS</span>(<span class="dt">y=</span>y, <span class="dt">X =</span> X, <span class="dt">R=</span>A, <span class="dt">coef_only =</span> <span class="ot">TRUE</span>)<span class="op">$</span>coefficients</a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="kw">solve</span>(<span class="kw">t</span>(X)<span class="op">%*%</span><span class="kw">solve</span>(A)<span class="op">%*%</span>X)<span class="op">%*%</span><span class="kw">t</span>(X)<span class="op">%*%</span><span class="kw">solve</span>(A)<span class="op">%*%</span>y <span class="co"># the standard GLS equation gives the same</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="kw">GLS</span>(<span class="dt">y=</span>y, <span class="dt">X =</span> X, <span class="dt">R=</span>A)<span class="op">$</span>sigma2 <span class="co"># this gives the diffusion variance</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="kw">var</span>(<span class="kw">solve</span>(<span class="kw">t</span>(<span class="kw">chol</span>(A)))<span class="op">%*%</span>y)  <span class="co"># gives the same</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"></a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="co"># also checking if Almer gives similar</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="kw">dimnames</span>(A)</a>
<a class="sourceLine" id="cb13-20" data-line-number="20">ind &lt;-<span class="st"> </span><span class="kw">colnames</span>(A)</a>
<a class="sourceLine" id="cb13-21" data-line-number="21"><span class="kw">Almer</span>(y<span class="op">~</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>ind), <span class="dt">A =</span> <span class="kw">list</span>(<span class="dt">ind =</span> Matrix<span class="op">::</span><span class="kw">Matrix</span>(A, <span class="dt">sparse =</span> <span class="ot">TRUE</span>))) <span class="co">#gives very similar results</span></a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">n =<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3">tree &lt;-<span class="st"> </span>geiger<span class="op">::</span><span class="kw">sim.bdtree</span>(<span class="dt">b =</span> <span class="dv">1</span>, <span class="dt">d =</span> <span class="dv">0</span>, <span class="dt">n =</span> n, <span class="dt">t =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#ape::is.ultrametric(tree)</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5">tree<span class="op">$</span>edge.length &lt;-<span class="st"> </span>tree<span class="op">$</span>edge.length<span class="op">/</span><span class="kw">diag</span>(ape<span class="op">::</span><span class="kw">vcv</span>(tree))[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">A &lt;-<span class="st"> </span>ape<span class="op">::</span><span class="kw">vcv</span>(tree)</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">V &lt;-<span class="st"> </span>A</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">V &lt;-<span class="st"> </span>Matrix<span class="op">::</span><span class="kw">Matrix</span>(V, <span class="dt">sparse =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb14-9" data-line-number="9"></a>
<a class="sourceLine" id="cb14-10" data-line-number="10">y &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">chol</span>(V))<span class="op">%*%</span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb14-11" data-line-number="11"></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="kw">system.time</span>(y_pred &lt;-<span class="st"> </span><span class="kw">macro_pred</span>(y, V, <span class="dt">useLFO =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb14-13" data-line-number="13">  <span class="co">#  user  system elapsed </span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14">  <span class="co"># 7.511   0.178   7.732 </span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="kw">plot</span>(y, y_pred)</a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb14-17" data-line-number="17"></a>
<a class="sourceLine" id="cb14-18" data-line-number="18">V &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">20</span>)<span class="co"># Matrix::Matrix(diag(20))</span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19">Matrix<span class="op">::</span><span class="kw">solve</span>(V)</a>
<a class="sourceLine" id="cb14-20" data-line-number="20">y_pred &lt;-<span class="st"> </span><span class="kw">macro_pred</span>(y, V, <span class="dt">useLFO =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb14-21" data-line-number="21"></a>
<a class="sourceLine" id="cb14-22" data-line-number="22">terminal.edges&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="kw">length</span>(tree<span class="op">$</span>tip.label))</a>
<a class="sourceLine" id="cb14-23" data-line-number="23">terminal.edges&lt;-tree<span class="op">$</span>edge.length[tree<span class="op">$</span>edge[<span class="dv">1</span><span class="op">:</span>(<span class="dv">2</span><span class="op">*</span><span class="kw">length</span>(tree<span class="op">$</span>tip.label)<span class="op">-</span><span class="dv">2</span>),<span class="dv">2</span>]<span class="op">&lt;=</span><span class="kw">length</span>(tree<span class="op">$</span>tip.label)]</a>
<a class="sourceLine" id="cb14-24" data-line-number="24"><span class="kw">plot</span>(terminal.edges, <span class="kw">abs</span>(y_pred<span class="op">-</span>y))</a>
<a class="sourceLine" id="cb14-25" data-line-number="25"></a>
<a class="sourceLine" id="cb14-26" data-line-number="26"><span class="co"># cecking the </span></a></code></pre></div>
</div>
<div id="old-stuff" class="section level1">
<h1>old stuff</h1>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># testing the R2 values</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co"># star phylogeny:</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4">tree &lt;-<span class="st"> </span>phytools<span class="op">::</span><span class="kw">starTree</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">100</span>))</a>
<a class="sourceLine" id="cb15-5" data-line-number="5"></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co"># predictor_BM model</span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7">mod &lt;-<span class="st"> </span><span class="kw">simulate_rate</span>(tree, <span class="dt">startv_x=</span><span class="dv">0</span>, <span class="dt">sigma_x=</span><span class="dv">1</span>, <span class="dt">a=</span><span class="dv">2</span>, <span class="dt">b=</span><span class="dv">1</span>, <span class="dt">model =</span> <span class="st">&quot;predictor_BM&quot;</span>)</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">gls_mod &lt;-<span class="st"> </span><span class="kw">rate_gls</span>(<span class="dt">x=</span>mod<span class="op">$</span>x, <span class="dt">y=</span>mod<span class="op">$</span>y, <span class="dt">species=</span>tree<span class="op">$</span>tip.label, tree, <span class="dt">model =</span> <span class="st">&quot;predictor_BM&quot;</span>, <span class="dt">maxiter =</span> <span class="dv">100</span>, <span class="dt">silent =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb15-9" data-line-number="9">gls_mod<span class="op">$</span>Rsquared</a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="kw">summary</span>(<span class="kw">lm</span>(gls_mod<span class="op">$</span>data<span class="op">$</span>y2<span class="op">~</span>gls_mod<span class="op">$</span>data<span class="op">$</span>x))<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb15-11" data-line-number="11"></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="kw">plot</span>(gls_mod)</a>
<a class="sourceLine" id="cb15-13" data-line-number="13"></a>
<a class="sourceLine" id="cb15-14" data-line-number="14">X &lt;-<span class="st"> </span><span class="kw">simulate</span>(gls_mod, <span class="dt">nsim =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb15-15" data-line-number="15"></a>
<a class="sourceLine" id="cb15-16" data-line-number="16"></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="co"># predictor_geometricBM model</span></a>
<a class="sourceLine" id="cb15-18" data-line-number="18">mod &lt;-<span class="st"> </span><span class="kw">rate_sim</span>(tree, <span class="dt">startv_x=</span><span class="dv">1</span>, <span class="dt">sigma_x=</span><span class="dv">1</span>, <span class="dt">a=</span><span class="dv">2</span>, <span class="dt">b=</span><span class="dv">1</span>, <span class="dt">model =</span> <span class="st">&quot;predictor_geometricBM&quot;</span>)</a>
<a class="sourceLine" id="cb15-19" data-line-number="19">gls_mod &lt;-<span class="st"> </span><span class="kw">rate_gls</span>(<span class="dt">x=</span>mod<span class="op">$</span>x, <span class="dt">y=</span>mod<span class="op">$</span>y, <span class="dt">species=</span>tree<span class="op">$</span>tip.label, tree, <span class="dt">model =</span> <span class="st">&quot;predictor_geometricBM&quot;</span>, <span class="dt">maxiter =</span> <span class="dv">100</span>, <span class="dt">silent =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb15-20" data-line-number="20">gls_mod<span class="op">$</span>Rsquared</a>
<a class="sourceLine" id="cb15-21" data-line-number="21"><span class="kw">summary</span>(<span class="kw">lm</span>(gls_mod<span class="op">$</span>data<span class="op">$</span>y2<span class="op">~</span>gls_mod<span class="op">$</span>data<span class="op">$</span>x))<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb15-22" data-line-number="22"></a>
<a class="sourceLine" id="cb15-23" data-line-number="23"><span class="co"># residual_rate model</span></a>
<a class="sourceLine" id="cb15-24" data-line-number="24"><span class="co"># This one should not be exactly equal</span></a>
<a class="sourceLine" id="cb15-25" data-line-number="25">mod &lt;-<span class="st"> </span><span class="kw">rate_sim</span>(tree, <span class="dt">startv_x=</span><span class="dv">0</span>, <span class="dt">sigma_x=</span><span class="dv">1</span>, <span class="dt">a=</span><span class="dv">2</span>, <span class="dt">b=</span><span class="dv">1</span>, <span class="dt">model =</span> <span class="st">&quot;residual_rate&quot;</span>)</a>
<a class="sourceLine" id="cb15-26" data-line-number="26">gls_mod &lt;-<span class="st"> </span><span class="kw">rate_gls</span>(<span class="dt">x=</span>mod<span class="op">$</span>x, <span class="dt">y=</span>mod<span class="op">$</span>y, <span class="dt">species=</span>tree<span class="op">$</span>tip.label, tree, <span class="dt">model =</span> <span class="st">&quot;residual_rate&quot;</span>, <span class="dt">maxiter =</span> <span class="dv">100</span>, <span class="dt">silent =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb15-27" data-line-number="27">gls_mod<span class="op">$</span>Rsquared</a>
<a class="sourceLine" id="cb15-28" data-line-number="28"><span class="kw">summary</span>(<span class="kw">lm</span>(gls_mod<span class="op">$</span>data<span class="op">$</span>y2<span class="op">~</span>gls_mod<span class="op">$</span>data<span class="op">$</span>x))<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb15-29" data-line-number="29"></a>
<a class="sourceLine" id="cb15-30" data-line-number="30"><span class="co"># R2 in ideal situation:</span></a>
<a class="sourceLine" id="cb15-31" data-line-number="31">n &lt;-<span class="st"> </span><span class="dv">100000</span>  <span class="co">#total sample size</span></a>
<a class="sourceLine" id="cb15-32" data-line-number="32">x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">each =</span> n<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb15-33" data-line-number="33">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rnorm</span>(n<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="kw">rnorm</span>(n<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb15-34" data-line-number="34"><span class="kw">summary</span>(<span class="kw">lm</span>(y<span class="op">^</span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span>x))<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb15-35" data-line-number="35"></a>
<a class="sourceLine" id="cb15-36" data-line-number="36"><span class="kw">plot</span>(x, y<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb15-37" data-line-number="37"></a>
<a class="sourceLine" id="cb15-38" data-line-number="38">tree &lt;-<span class="st"> </span>phytools<span class="op">::</span><span class="kw">starTree</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="kw">rep</span>(<span class="dv">1</span>, n))</a>
<a class="sourceLine" id="cb15-39" data-line-number="39">gls_mod &lt;-<span class="st"> </span><span class="kw">rate_gls</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">species=</span>tree<span class="op">$</span>tip.label, tree, <span class="dt">model =</span> <span class="st">&quot;predictor_BM&quot;</span>, <span class="dt">maxiter =</span> <span class="dv">100</span>, <span class="dt">silent =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb15-40" data-line-number="40">gls_mod<span class="op">$</span>Rsquared</a>
<a class="sourceLine" id="cb15-41" data-line-number="41"><span class="kw">summary</span>(<span class="kw">lm</span>(gls_mod<span class="op">$</span>data<span class="op">$</span>y2<span class="op">~</span>gls_mod<span class="op">$</span>data<span class="op">$</span>x))<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb15-42" data-line-number="42"><span class="co"># NB this is half of what Thomas derived analytically</span></a>
<a class="sourceLine" id="cb15-43" data-line-number="43"></a>
<a class="sourceLine" id="cb15-44" data-line-number="44"><span class="co"># analytic derivation:</span></a>
<a class="sourceLine" id="cb15-45" data-line-number="45"><span class="co"># within group var for y^2 is 2*var(y)^2 (derivated from results in Bohrnstedt and Goldberger 1969 + fourth moment of normal = 3*var[y]^2)</span></a>
<a class="sourceLine" id="cb15-46" data-line-number="46"><span class="co"># avarage within group variation is </span></a>
<a class="sourceLine" id="cb15-47" data-line-number="47"><span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">2</span><span class="op">*</span><span class="dv">1</span>, <span class="dv">2</span><span class="op">*</span>(<span class="dv">2</span><span class="op">^</span><span class="dv">2</span>))) <span class="co"># = 5</span></a>
<a class="sourceLine" id="cb15-48" data-line-number="48"><span class="co"># mean of the two grups are 1 and sqrt(2)</span></a>
<a class="sourceLine" id="cb15-49" data-line-number="49"><span class="co"># the between group mean square is </span></a>
<a class="sourceLine" id="cb15-50" data-line-number="50">((<span class="dv">2-1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span> <span class="co"># = 0.25</span></a>
<a class="sourceLine" id="cb15-51" data-line-number="51"><span class="co"># R2 is</span></a>
<a class="sourceLine" id="cb15-52" data-line-number="52"><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="dv">5</span><span class="op">/</span>(<span class="dv">5</span><span class="fl">+0.25</span>)</a>
<a class="sourceLine" id="cb15-53" data-line-number="53"><span class="dv">1</span><span class="op">/</span><span class="dv">21</span></a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co"># testing:</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3">tree &lt;-<span class="st"> </span>geiger<span class="op">::</span><span class="kw">sim.bdtree</span>(<span class="dt">b =</span> <span class="dv">1</span>, <span class="dt">d =</span> <span class="dv">0</span>, <span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">t =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">tree<span class="op">$</span>edge.length &lt;-<span class="st"> </span>tree<span class="op">$</span>edge.length<span class="op">/</span><span class="kw">diag</span>(ape<span class="op">::</span><span class="kw">vcv</span>(tree))[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb16-5" data-line-number="5"></a>
<a class="sourceLine" id="cb16-6" data-line-number="6">mod &lt;-<span class="st"> </span><span class="kw">rate_sim</span>(tree, <span class="dt">startv_x=</span><span class="dv">3</span>, <span class="dt">sigma_x=</span><span class="dv">1</span>, <span class="dt">a=</span> <span class="fl">0.001</span>, <span class="dt">b=</span><span class="dv">1</span>, <span class="dt">model =</span> <span class="st">&quot;predictor_geometricBM&quot;</span>)</a>
<a class="sourceLine" id="cb16-7" data-line-number="7"></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co">#mod$y &lt;- mod$y + rnorm(length(mod$y))</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"></a>
<a class="sourceLine" id="cb16-11" data-line-number="11">gls_mod &lt;-<span class="st"> </span><span class="kw">rate_gls</span>(<span class="dt">x=</span>mod<span class="op">$</span>x, <span class="dt">y=</span>mod<span class="op">$</span>y, <span class="dt">species=</span>tree<span class="op">$</span>tip.label, tree, <span class="dt">model =</span> <span class="st">&quot;predictor_geometricBM&quot;</span>, <span class="dt">maxiter =</span> <span class="dv">100</span>, <span class="dt">silent =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb16-12" data-line-number="12"></a>
<a class="sourceLine" id="cb16-13" data-line-number="13"></a>
<a class="sourceLine" id="cb16-14" data-line-number="14">gls_mod<span class="op">$</span>param[<span class="st">&quot;a&quot;</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb16-15" data-line-number="15"></a>
<a class="sourceLine" id="cb16-16" data-line-number="16"><span class="kw">rate_sim</span>()</a>
<a class="sourceLine" id="cb16-17" data-line-number="17"></a>
<a class="sourceLine" id="cb16-18" data-line-number="18"></a>
<a class="sourceLine" id="cb16-19" data-line-number="19">A &lt;-ape<span class="op">::</span><span class="kw">vcv</span>(tree)</a>
<a class="sourceLine" id="cb16-20" data-line-number="20">C &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">chol</span>(A))</a>
<a class="sourceLine" id="cb16-21" data-line-number="21">R &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="kw">ncol</span>(A))<span class="op">*</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb16-22" data-line-number="22"></a>
<a class="sourceLine" id="cb16-23" data-line-number="23">sigma_x &lt;-<span class="st"> </span><span class="kw">var</span>(<span class="kw">solve</span>(C)<span class="op">%*%</span>mod<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb16-24" data-line-number="24"></a>
<a class="sourceLine" id="cb16-25" data-line-number="25">Ainv &lt;-<span class="st"> </span><span class="kw">solve</span>(A)</a>
<a class="sourceLine" id="cb16-26" data-line-number="26">Rinv &lt;-<span class="st"> </span><span class="kw">solve</span>(R)</a>
<a class="sourceLine" id="cb16-27" data-line-number="27"></a>
<a class="sourceLine" id="cb16-28" data-line-number="28">x1 &lt;-<span class="st"> </span><span class="kw">solve</span>(C)<span class="op">%*%</span>(mod<span class="op">$</span>x<span class="op">-</span><span class="kw">mean</span>(mod<span class="op">$</span>x))</a>
<a class="sourceLine" id="cb16-29" data-line-number="29">x2 &lt;-<span class="st"> </span><span class="kw">solve</span>(Rinv<span class="op">+</span><span class="kw">solve</span>(<span class="kw">c</span>(sigma_x)<span class="op">*</span>A))<span class="op">%*%</span>Rinv<span class="op">%*%</span>(mod<span class="op">$</span>x<span class="op">-</span><span class="kw">mean</span>(mod<span class="op">$</span>x))</a>
<a class="sourceLine" id="cb16-30" data-line-number="30">x3 &lt;-<span class="st"> </span>(A<span class="op">-</span><span class="kw">solve</span>(<span class="kw">diag</span>(<span class="dt">x =</span> <span class="kw">diag</span>(Ainv))))<span class="op">%*%</span>Ainv<span class="op">%*%</span>(mod<span class="op">$</span>x<span class="op">-</span><span class="kw">mean</span>(mod<span class="op">$</span>x))</a>
<a class="sourceLine" id="cb16-31" data-line-number="31">x4 &lt;-<span class="st"> </span>A<span class="op">%*%</span><span class="kw">solve</span>(A<span class="op">+</span>R)<span class="op">%*%</span>(mod<span class="op">$</span>x<span class="op">-</span><span class="kw">mean</span>(mod<span class="op">$</span>x))</a>
<a class="sourceLine" id="cb16-32" data-line-number="32">  </a>
<a class="sourceLine" id="cb16-33" data-line-number="33"><span class="kw">plot</span>(x2, x4)</a>
<a class="sourceLine" id="cb16-34" data-line-number="34"><span class="kw">plot</span>(mod<span class="op">$</span>x, x4)</a>
<a class="sourceLine" id="cb16-35" data-line-number="35">  </a>
<a class="sourceLine" id="cb16-36" data-line-number="36"><span class="kw">plot</span>(<span class="kw">solve</span>(C)<span class="op">%*%</span>mod<span class="op">$</span>x, <span class="kw">solve</span>(Rinv<span class="op">+</span><span class="kw">solve</span>(<span class="kw">c</span>(sigma_x)<span class="op">*</span>A))<span class="op">%*%</span>Rinv<span class="op">%*%</span>(mod<span class="op">$</span>x<span class="op">-</span><span class="kw">mean</span>(mod<span class="op">$</span>x)))</a>
<a class="sourceLine" id="cb16-37" data-line-number="37"></a>
<a class="sourceLine" id="cb16-38" data-line-number="38"><span class="kw">plot</span>(<span class="kw">solve</span>(C)<span class="op">%*%</span>mod<span class="op">$</span>x, (A<span class="op">-</span><span class="kw">solve</span>(<span class="kw">diag</span>(<span class="dt">x =</span> <span class="kw">diag</span>(Ainv))))<span class="op">%*%</span>Ainv<span class="op">%*%</span>(mod<span class="op">$</span>x<span class="op">-</span><span class="kw">mean</span>(mod<span class="op">$</span>x)))</a>
<a class="sourceLine" id="cb16-39" data-line-number="39"></a>
<a class="sourceLine" id="cb16-40" data-line-number="40"></a>
<a class="sourceLine" id="cb16-41" data-line-number="41"><span class="co">#### testing almer</span></a>
<a class="sourceLine" id="cb16-42" data-line-number="42">tree &lt;-<span class="st"> </span>geiger<span class="op">::</span><span class="kw">sim.bdtree</span>(<span class="dt">b =</span> <span class="dv">1</span>, <span class="dt">d =</span> <span class="dv">0</span>, <span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">t =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb16-43" data-line-number="43">tree<span class="op">$</span>edge.length &lt;-<span class="st"> </span>tree<span class="op">$</span>edge.length<span class="op">/</span><span class="kw">diag</span>(ape<span class="op">::</span><span class="kw">vcv</span>(tree))[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb16-44" data-line-number="44">mod &lt;-<span class="st"> </span><span class="kw">rate_sim</span>(tree, <span class="dt">startv_x=</span><span class="dv">3</span>, <span class="dt">sigma_x=</span><span class="dv">1</span>, <span class="dt">a=</span> <span class="fl">0.001</span>, <span class="dt">b=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb16-45" data-line-number="45">A &lt;-<span class="st"> </span>Matrix<span class="op">::</span><span class="kw">Matrix</span>(ape<span class="op">::</span><span class="kw">vcv</span>(tree), <span class="dt">sparse =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb16-46" data-line-number="46"><span class="co">#A &lt;- as(A, &quot;dgCMatrix&quot;)</span></a>
<a class="sourceLine" id="cb16-47" data-line-number="47"><span class="co"># colnames(A) &lt;- paste(&quot;q&quot;, 1:100)</span></a>
<a class="sourceLine" id="cb16-48" data-line-number="48"><span class="co"># rownames(A) &lt;- paste(&quot;q&quot;, 1:100)</span></a>
<a class="sourceLine" id="cb16-49" data-line-number="49">dt &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">species =</span> <span class="kw">paste</span>(<span class="st">&quot;s&quot;</span>, mod<span class="op">$</span>species, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb16-50" data-line-number="50">                 <span class="dt">x =</span> mod<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb16-51" data-line-number="51"></a>
<a class="sourceLine" id="cb16-52" data-line-number="52"><span class="kw">Almer</span>(<span class="dt">formula =</span> x <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>species), <span class="dt">data =</span> dt, <span class="dt">A =</span> <span class="kw">list</span>(<span class="dt">species =</span> A))</a>
<a class="sourceLine" id="cb16-53" data-line-number="53">A &lt;-<span class="st"> </span>A[<span class="dv">100-0</span><span class="op">:</span><span class="dv">99</span>, <span class="dv">100-0</span><span class="op">:</span><span class="dv">99</span>]</a>
<a class="sourceLine" id="cb16-54" data-line-number="54"><span class="kw">Almer</span>(<span class="dt">formula =</span> x <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>species), <span class="dt">data =</span> dt, <span class="dt">A =</span> <span class="kw">list</span>(<span class="dt">species =</span> A))</a>
<a class="sourceLine" id="cb16-55" data-line-number="55"></a>
<a class="sourceLine" id="cb16-56" data-line-number="56">mod &lt;-<span class="st"> </span><span class="kw">Almer</span>(<span class="dt">formula =</span> x <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>species), <span class="dt">data =</span> dt, <span class="dt">A =</span> <span class="kw">list</span>(<span class="dt">species =</span> A))</a>
<a class="sourceLine" id="cb16-57" data-line-number="57"></a>
<a class="sourceLine" id="cb16-58" data-line-number="58"></a>
<a class="sourceLine" id="cb16-59" data-line-number="59"><span class="co">##### residual rate simulation #####</span></a>
<a class="sourceLine" id="cb16-60" data-line-number="60">b_true &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)<span class="op">/</span><span class="dv">20</span></a>
<a class="sourceLine" id="cb16-61" data-line-number="61">b_est &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb16-62" data-line-number="62"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(b_true)){</a>
<a class="sourceLine" id="cb16-63" data-line-number="63">  n &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb16-64" data-line-number="64">  tree &lt;-<span class="st"> </span>geiger<span class="op">::</span><span class="kw">sim.bdtree</span>(<span class="dt">b =</span> <span class="dv">1</span>, <span class="dt">d =</span> <span class="dv">0</span>, <span class="dt">n =</span> n, <span class="dt">t =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb16-65" data-line-number="65">  tree<span class="op">$</span>edge.length &lt;-<span class="st"> </span>tree<span class="op">$</span>edge.length<span class="op">/</span><span class="kw">diag</span>(ape<span class="op">::</span><span class="kw">vcv</span>(tree))[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb16-66" data-line-number="66">  </a>
<a class="sourceLine" id="cb16-67" data-line-number="67">  x &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">rnorm</span>(n))</a>
<a class="sourceLine" id="cb16-68" data-line-number="68">  </a>
<a class="sourceLine" id="cb16-69" data-line-number="69">  dt &lt;-<span class="st"> </span><span class="kw">rate_sim</span>(tree, <span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> b_true[i], <span class="dt">x =</span> x, <span class="dt">model =</span> <span class="st">&quot;residual_rate&quot;</span>)</a>
<a class="sourceLine" id="cb16-70" data-line-number="70">  mod &lt;-<span class="st"> </span><span class="kw">rate_gls</span>(<span class="dt">x=</span>dt<span class="op">$</span>x, <span class="dt">y=</span>dt<span class="op">$</span>y, <span class="dt">species=</span>dt<span class="op">$</span>species, tree, <span class="dt">model =</span> <span class="st">&quot;residual_rate&quot;</span>, <span class="dt">maxiter =</span> <span class="dv">100</span>, <span class="dt">silent =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb16-71" data-line-number="71">                      <span class="dt">startv =</span> <span class="kw">list</span>(<span class="dt">a=</span><span class="ot">NULL</span>, <span class="dt">b=</span><span class="ot">NULL</span>))</a>
<a class="sourceLine" id="cb16-72" data-line-number="72">  <span class="cf">if</span>(mod<span class="op">$</span>convergence <span class="op">==</span><span class="st"> &quot;Convergence&quot;</span>) b_est[i] &lt;-<span class="st"> </span>mod<span class="op">$</span>param[<span class="st">&quot;b&quot;</span>, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb16-73" data-line-number="73">  <span class="cf">else</span> b_est[i] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb16-74" data-line-number="74">  </a>
<a class="sourceLine" id="cb16-75" data-line-number="75">}</a>
<a class="sourceLine" id="cb16-76" data-line-number="76"></a>
<a class="sourceLine" id="cb16-77" data-line-number="77"><span class="kw">plot</span>(b_true, b_est)</a>
<a class="sourceLine" id="cb16-78" data-line-number="78"><span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb16-79" data-line-number="79"><span class="kw">abline</span>(<span class="kw">lm</span>(b_est<span class="op">~</span>b_true[<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(b_est)]))</a>
<a class="sourceLine" id="cb16-80" data-line-number="80"></a>
<a class="sourceLine" id="cb16-81" data-line-number="81"></a>
<a class="sourceLine" id="cb16-82" data-line-number="82">mod<span class="op">$</span>param</a>
<a class="sourceLine" id="cb16-83" data-line-number="83"></a>
<a class="sourceLine" id="cb16-84" data-line-number="84"><span class="kw">boot.rate_gls</span>(mod)</a></code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
